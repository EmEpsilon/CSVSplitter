# CSVSplitter

## 概要

* CSVファイルをソート、分割し、所定のフォルダに出力します。
* 処理対象のCSVファイルは、1つまたは複数を選択できます。
* 巨大なCSVファイルでも多くのメモリを使用せず、処理が可能です。

## システム要件

* .NET Framework 4.6.2以上が入っている、Windows上で動作します。

## 操作方法

1. 「1.対象ファイルをここにドロップしてください。」に、CSVファイルをドロップしてください。
   * 複数ある場合は、分けてドロップすることも可能です。
2. CSVファイルのドロップが完了したら、「2.処理対象のCSVファイル～」の右下にある、「分析」ボタンを押してください。
3. 「3.対象ファイルの分析結果」の内容を確認します。
   * 出力メッセージ例

| メッセージ                                          | 説明                                                       |
| ---------------------------------------------- | -------------------------------------------------------- |
| CSVではないファイルがあります。                              | 対象ファイルの中に、CSVではないファイルがあります。                              |
| 分割・出力できないため、リセットボタンを押し、対象外のファイルを除いて取り込みなおしてください。  | 処理を進めることができないため、右上の「リセット」ボタンを押し、CSVファイルのみドロップしない押してください。 |
| すべてのファイルのヘッダーと文字コードが一致しています。複数ファイルの統合ができます。    | 対象ファイルのヘッダーの内容と、文字コードが一致しているため、複数ファイルを統合して処理することができます。   |
| すべてのファイルのヘッダーと文字コードが一致していません。ファイルごとの分割を実施できます。 | 対象ファイルのヘッダーの内容と、文字コードが一致していないため、複数ファイルを統合して処理することができません。 |
| 分割・出力できます。                                        | 4以降の操作ができます。                                             |

4. 「変換条件」の指定を行います。
  * ソート条件
    * 出力するファイルのソート条件を指定します。
    * コンボボックスからソートする項目を指定します。複数選んだ場合は、頭から順番に適用されます。
      * 降順に並び替える場合は、「降順」にチェックを入れます。
      * 対象の項目が数値の場合は、「数値」にチェックを入れます。
  * 分割条件
    * 出力するファイルの分割条件を指定します。
    * コンボボックスから分割条件となる項目を指定します。指定した項目を条件にファイルを分割します。複数選んだ場合は、すべて適用されます。
      * 例として、あるCSVファイルにA項目があり、A項目に「1」、「2」、「3」のどれかの内容がセットされている場合、それぞれA項目の「1」、「2」、「3」が含まれるファイルが3つ作成されます。
  * 複数のCSVファイルを統合する
    * 複数ファイルを1つのCSVに統合した上で処理します。
      * 対象ファイル全て同じ項目と文字コードのCSVファイルの場合、選択可能です。
  * CSV出力最大行数
    * 出力するCSVファイルの最大行数を指定します。(EXCELの最大行数対応)
      * 最大行数を超えるような場合は、ファイルを分割します。
5. 4の「変換条件」を指定後
  * 出力フォルダを指定します。
  * 最後に「変換開始」ボタンを押します。
  * 「変換が完了しました。」のメッセージが表示されたら、ファイル出力が完了です。
    * 「出力先フォルダを開く」を押すと、出力先のフォルダを開くことができます。

## 使用しているライブラリ

* [CsvHelper](https://github.com/JoshClose/CsvHelper)
  - CSVファイルの読み込みに使用
* [ReadJEnc](https://github.com/hnx8/ReadJEnc)
  - 文字コード判定
* [Microsoft-WindowsAPICodePack-Shell](https://www.nuget.org/packages/Microsoft-WindowsAPICodePack-Shell/)
  - 出力先フォルダ指定の機能で使用

# その他参考にしているサイト

* secretbase.log [WPFアプリケーションをEXEひとつにまとめる](https://cointoss.hatenablog.com/entry/2017/02/21/121209)
  - dllをexeにまとめる方法として参考にさせていただきました。
  - 大本のサイト http://www.digitallycreated.net/Blog/61/combining-multiple-assemblies-into-a-single-exe-for-a-wpf-application

## 作者

* [X](https://twitter.com/Em_epsilon)
